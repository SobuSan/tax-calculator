<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Income Tax Calculator (Salary) - FY 2025-26</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            color: #667eea;
            margin-bottom: 8px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .input-group label {
            font-size: 14px;
            color: #555;
            margin-bottom: 5px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .tooltip-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            font-size: 11px;
            line-height: 16px;
            cursor: help;
            font-weight: bold;
            position: relative;
            margin-left: 4px;
        }

        .tooltip {
            position: absolute;
            bottom: 25px;
            left: -10px;
            background: #333;
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 12px;
            width: 280px;
            z-index: 1000;
            display: none;
            line-height: 1.5;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            font-weight: normal;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #333;
        }

        .tooltip-icon:hover .tooltip {
            display: block;
        }
        
        .input-group label {
            position: relative;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .info-text {
            font-size: 12px;
            color: #888;
            margin-top: 3px;
        }

        .toggle-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: #f0f0f0;
            padding: 5px;
            border-radius: 8px;
            width: fit-content;
        }

        .toggle-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            color: #666;
        }

        .toggle-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 14px;
            color: #1565c0;
        }

        .info-box strong {
            display: block;
            margin-bottom: 5px;
        }

        .help-section {
            background: #fff9e6;
            border: 2px solid #ffd54f;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .help-section h3 {
            color: #f57c00;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .help-section ul {
            margin-left: 20px;
            color: #666;
            font-size: 14px;
        }

        .help-section li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #555;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .results {
            display: none;
            margin-top: 30px;
        }

        .results.show {
            display: block;
        }

        .comparison-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .regime-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            background: #fafafa;
        }

        .regime-card.recommended {
            border-color: #4caf50;
            background: #f1f8f4;
            position: relative;
        }

        .regime-card.recommended::before {
            content: "‚úì Recommended";
            position: absolute;
            top: -12px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .regime-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .tax-amount {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
            margin: 15px 0;
        }

        .regime-card.recommended .tax-amount {
            color: #4caf50;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            font-size: 14px;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-row strong {
            color: #333;
        }

        .working-section {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .working-section h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .calculation-step {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }

        .calculation-step:last-child {
            margin-bottom: 0;
        }

        .ai-recommendation {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .ai-recommendation h3 {
            color: #2e7d32;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ai-recommendation h3::before {
            content: "ü§ñ";
            font-size: 24px;
        }

        .ai-recommendation p {
            color: #1b5e20;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toggle-section {
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-section::before {
            content: "‚ñº";
            font-size: 12px;
            transition: transform 0.3s;
        }

        .toggle-section.collapsed::before {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .collapsible-content.collapsed {
            max-height: 0;
        }

        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }

            .comparison-cards {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        .savings-highlight {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .savings-highlight strong {
            color: #ff6f00;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Income Tax Calculator (Salary)</h1>
            <p>Assessment Year 2026-27 (Financial Year 2025-26) | Powered by AI</p>
        </div>

        <div class="content">
            <!-- Help Section -->
            <div class="help-section">
                <h3>üìò How to Use This Calculator</h3>
                <ul>
                    <li><strong>Step 1:</strong> Enter your salary details (you can switch between monthly and annual view)</li>
                    <li><strong>Step 2:</strong> Add any tax-saving investments you've made (these help reduce your tax in the Old Regime)</li>
                    <li><strong>Step 3:</strong> Click "Calculate Tax" to see which tax regime saves you more money</li>
                    <li><strong>Hover over the "?" icons</strong> next to each field to understand what it means</li>
                </ul>
            </div>

            <!-- Tax Slab Reference Section -->
            <div class="section">
                <h2 class="section-title">üìä Tax Slab Reference - FY 2025-26</h2>
                <div class="section-description">
                    <strong>Quick Reference:</strong> Here are the tax rates for both regimes. The calculator will automatically apply these based on your income.
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 20px;">
                    <!-- New Tax Regime (Default) -->
                    <div style="background: #e8f5e9; border: 2px solid #4caf50; border-radius: 10px; padding: 20px;">
                        <h3 style="color: #2e7d32; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                            <span style="background: #4caf50; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">DEFAULT</span>
                            New Tax Regime
                        </h3>
                        <p style="font-size: 13px; color: #1b5e20; margin-bottom: 15px;">
                            <strong>‚úì Benefits:</strong> Lower tax rates, simpler to use<br>
                            <strong>‚úó No deductions</strong> allowed (except ‚Çπ75,000 standard deduction)
                        </p>
                        <table style="width: 100%; font-size: 13px; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #c8e6c9; text-align: left;">
                                    <th style="padding: 10px; border: 1px solid #a5d6a7;">Income Range (‚Çπ)</th>
                                    <th style="padding: 10px; border: 1px solid #a5d6a7;">Tax Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">0 - 4,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>Nil</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">4,00,001 - 8,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>5%</strong></td>
                                </tr>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">8,00,001 - 12,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>10%</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">12,00,001 - 16,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>15%</strong></td>
                                </tr>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">16,00,001 - 20,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>20%</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">20,00,001 - 24,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>25%</strong></td>
                                </tr>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;">Above 24,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #c8e6c9;"><strong>30%</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="font-size: 12px; color: #558b2f; margin-top: 10px; font-style: italic;">
                            üí° Rebate: If income ‚â§ ‚Çπ7 lakhs, up to ‚Çπ60,000 tax rebate under Section 87A
                        </p>
                    </div>

                    <!-- Old Tax Regime (Optional) -->
                    <div style="background: #fff3e0; border: 2px solid #ff9800; border-radius: 10px; padding: 20px;">
                        <h3 style="color: #e65100; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                            <span style="background: #ff9800; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 600;">OPTIONAL</span>
                            Old Tax Regime
                        </h3>
                        <p style="font-size: 13px; color: #e65100; margin-bottom: 15px;">
                            <strong>‚úì Benefits:</strong> Can claim deductions (80C, HRA, etc.)<br>
                            <strong>‚úó Higher tax rates</strong> compared to new regime
                        </p>
                        <table style="width: 100%; font-size: 13px; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #ffe0b2; text-align: left;">
                                    <th style="padding: 10px; border: 1px solid #ffcc80;">Income Range (‚Çπ)</th>
                                    <th style="padding: 10px; border: 1px solid #ffcc80;">Tax Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;">0 - 2,50,000</td>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;"><strong>Nil</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;">2,50,001 - 5,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;"><strong>5%</strong></td>
                                </tr>
                                <tr style="background: white;">
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;">5,00,001 - 10,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;"><strong>20%</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;">Above 10,00,000</td>
                                    <td style="padding: 8px; border: 1px solid #ffe0b2;"><strong>30%</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="font-size: 12px; color: #f57c00; margin-top: 10px; font-style: italic;">
                            üí° Rebate: If income ‚â§ ‚Çπ5 lakhs, up to ‚Çπ12,500 tax rebate under Section 87A
                        </p>
                        <div style="background: white; padding: 12px; border-radius: 6px; margin-top: 12px; border-left: 3px solid #ff9800;">
                            <strong style="color: #e65100; font-size: 13px;">Available Deductions:</strong>
                            <ul style="margin-top: 8px; margin-left: 20px; font-size: 12px; color: #666;">
                                <li>Section 80C: Up to ‚Çπ1.5 lakhs</li>
                                <li>Section 80D: Up to ‚Çπ25k-‚Çπ50k</li>
                                <li>HRA Exemption (if renting)</li>
                                <li>NPS 80CCD(1B): Additional ‚Çπ50k</li>
                                <li>Education Loan (80E): No limit</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 20px;">
                    <strong>üìå Important Note:</strong> Both regimes offer ‚Çπ75,000 standard deduction. Health and Education Cess of 4% is added to the final tax in both regimes.
                </div>
            </div>

            <!-- Income Section -->
            <div class="section">
                <h2 class="section-title">üí∞ Step 1: Your Income</h2>
                <div class="section-description">
                    <strong>What is this?</strong> Your total earnings from your job. This includes your basic salary and all the allowances you receive.
                </div>

                <div class="toggle-container">
                    <button class="toggle-btn active" onclick="toggleInputMode('annual')">Annual (Yearly)</button>
                    <button class="toggle-btn" onclick="toggleInputMode('monthly')">Monthly</button>
                </div>

                <div class="info-box">
                    <strong>üí° Quick Tip:</strong>
                    If you're not sure about some components, just enter your total salary. The basic calculations will still work! Check your salary slip to find these breakdowns.
                </div>

                <div class="input-grid">
                    <div class="input-group">
                        <label for="basic-salary">
                            Basic Salary
                            <span class="tooltip-icon">?
                                <span class="tooltip">This is the main part of your salary before any allowances. Usually 40-50% of your total salary. Found on your salary slip as "Basic Pay".</span>
                            </span>
                        </label>
                        <input type="number" id="basic-salary" placeholder="e.g., 50000" value="0">
                        <span class="info-text" id="basic-info">Monthly amount</span>
                    </div>
                    <div class="input-group">
                        <label for="hra">
                            House Rent Allowance (HRA)
                            <span class="tooltip-icon">?
                                <span class="tooltip">Money your employer gives you to pay rent. If you live in a rented house, this can help reduce your tax. Check your salary slip for "HRA".</span>
                            </span>
                        </label>
                        <input type="number" id="hra" placeholder="e.g., 20000" value="0">
                        <span class="info-text" id="hra-info">Monthly amount</span>
                    </div>
                    <div class="input-group">
                        <label for="special-allowance">
                            Special Allowance
                            <span class="tooltip-icon">?
                                <span class="tooltip">Additional fixed amount you get every month. Sometimes called "Other Allowance" or "Variable Pay". Check your salary slip.</span>
                            </span>
                        </label>
                        <input type="number" id="special-allowance" placeholder="e.g., 15000" value="0">
                        <span class="info-text" id="special-info">Monthly amount</span>
                    </div>
                    <div class="input-group">
                        <label for="other-allowances">
                            Other Allowances
                            <span class="tooltip-icon">?
                                <span class="tooltip">Any other regular allowances like transport, meal, or conveyance allowance. Check your salary slip for details.</span>
                            </span>
                        </label>
                        <input type="number" id="other-allowances" placeholder="e.g., 5000" value="0">
                        <span class="info-text" id="other-info">Monthly amount</span>
                    </div>
                    <div class="input-group">
                        <label for="bonus">
                            Bonus / Performance Pay
                            <span class="tooltip-icon">?
                                <span class="tooltip">Extra money you receive as bonus, incentive, or performance pay during the year. This is always annual.</span>
                            </span>
                        </label>
                        <input type="number" id="bonus" placeholder="e.g., 100000" value="0">
                        <span class="info-text">Annual amount</span>
                    </div>
                    <div class="input-group">
                        <label for="other-income">
                            Other Income
                            <span class="tooltip-icon">?
                                <span class="tooltip">Any other income like bank interest, freelancing, or rental income. This is annual.</span>
                            </span>
                        </label>
                        <input type="number" id="other-income" placeholder="e.g., 25000" value="0">
                        <span class="info-text">Annual amount</span>
                    </div>
                </div>
            </div>

            <!-- Deductions for Old Regime -->
            <div class="section">
                <h2 class="section-title">üéØ Step 2: Your Tax-Saving Investments</h2>
                <div class="section-description">
                    <strong>What is this?</strong> These are investments and expenses that can reduce your taxable income in the <strong>Old Tax Regime</strong>. If you haven't made any investments, just leave these as zero. The New Tax Regime doesn't allow these deductions but has lower tax rates.
                </div>

                <div class="info-box">
                    <strong>üí° Common Tax-Saving Options:</strong>
                    PPF, Employee Provident Fund (EPF/PF), Life Insurance, ELSS Mutual Funds, Tax Saver FD, National Pension System (NPS), Health Insurance, Education Loan Interest
                </div>

                <div class="input-grid">
                    <div class="input-group">
                        <label for="section-80c">
                            Section 80C Investments
                            <span class="tooltip-icon">?
                                <span class="tooltip">Popular tax-saving investments: PPF, Employee PF (EPF), Life Insurance premiums, ELSS mutual funds, Tax Saver FD, NSC, home loan principal. Maximum benefit: ‚Çπ1.5 lakh per year.</span>
                            </span>
                        </label>
                        <input type="number" id="section-80c" placeholder="Max: 150000" value="0">
                        <span class="info-text">Maximum deduction: ‚Çπ1,50,000 per year</span>
                    </div>
                    <div class="input-group">
                        <label for="section-80d">
                            Health Insurance Premium
                            <span class="tooltip-icon">?
                                <span class="tooltip">Premium you pay for health/medical insurance for yourself and family. ‚Çπ25,000 limit for self/family. Additional ‚Çπ25,000 for parents (‚Çπ50,000 if parents are senior citizens aged 60+).</span>
                            </span>
                        </label>
                        <input type="number" id="section-80d" placeholder="Max: 25000/50000" value="0">
                        <span class="info-text">‚Çπ25,000 (self) / ‚Çπ50,000 (senior citizen parents)</span>
                    </div>
                    <div class="input-group">
                        <label for="section-80ccd">
                            National Pension System (NPS)
                            <span class="tooltip-icon">?
                                <span class="tooltip">Additional deduction if you invest in NPS. This is EXTRA benefit beyond Section 80C. You can claim up to ‚Çπ50,000 more for NPS contributions under this section.</span>
                            </span>
                        </label>
                        <input type="number" id="section-80ccd" placeholder="Max: 50000" value="0">
                        <span class="info-text">Additional ‚Çπ50,000 for NPS (beyond 80C limit)</span>
                    </div>
                    <div class="input-group">
                        <label for="section-80e">
                            Education Loan Interest
                            <span class="tooltip-icon">?
                                <span class="tooltip">Only the INTEREST (not principal) you paid on education loan for higher studies. No upper limit! Enter the total interest amount paid this year.</span>
                            </span>
                        </label>
                        <input type="number" id="section-80e" placeholder="Interest paid" value="0">
                        <span class="info-text">No maximum limit - only interest portion</span>
                    </div>
                    <div class="input-group">
                        <label for="rent-paid">
                            Annual Rent Paid
                            <span class="tooltip-icon">?
                                <span class="tooltip">Total rent you paid for the year. Needed to calculate HRA exemption. If you live in your own house or with parents, enter 0.</span>
                            </span>
                        </label>
                        <input type="number" id="rent-paid" placeholder="Annual rent paid" value="0">
                        <span class="info-text">Total rent paid for the whole year</span>
                    </div>
                    <div class="input-group">
                        <label for="metro-city">
                            Do you live in a Metro City?
                            <span class="tooltip-icon">?
                                <span class="tooltip">Metro cities are: Mumbai, Delhi, Kolkata, and Chennai. HRA exemption is higher (50% of basic) for metro cities vs non-metro (40% of basic).</span>
                            </span>
                        </label>
                        <select id="metro-city">
                            <option value="yes">Yes (Mumbai, Delhi, Kolkata, Chennai)</option>
                            <option value="no">No (All other cities)</option>
                        </select>
                        <span class="info-text">Affects HRA exemption calculation</span>
                    </div>
                </div>
            </div>

            <!-- Standard Deduction -->
            <div class="section">
                <h2 class="section-title">üíº Standard Deduction - Automatic Benefit</h2>
                <div class="section-description">
                    <strong>Good news!</strong> You automatically get a ‚Çπ75,000 deduction from your income in <strong>BOTH</strong> tax regimes (Old and New). This is a flat benefit for all salaried people - you don't need to do anything to claim it. We'll apply this automatically in your calculations.
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="button-group">
                <button class="btn btn-primary" onclick="calculateTax()">Calculate Tax</button>
                <button class="btn btn-secondary" onclick="resetForm()">Reset</button>
            </div>

            <!-- Loading -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Analyzing your tax situation with AI...</p>
            </div>

            <!-- Results -->
            <div class="results" id="results">
                <div class="section">
                    <h2 class="section-title">üìä Your Tax Calculation Results</h2>
                    <div class="section-description">
                        <strong>What do these results mean?</strong> We've calculated your tax under both the Old and New tax regimes. The <span style="color: #4caf50; font-weight: bold;">recommended regime</span> is highlighted in green - this is the one that will save you more money!
                    </div>
                </div>

                <!-- AI Recommendation will be inserted here -->
                <div id="ai-recommendation"></div>

                <!-- Comparison Cards -->
                <div class="comparison-cards" id="comparison-cards"></div>

                <!-- Explanation Box -->
                <div class="info-box" style="background: #fff3e0; border-left-color: #ff9800;">
                    <strong>ü§î Understanding the Tax Regimes:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>Old Tax Regime:</strong> Higher tax rates BUT you can claim deductions for investments (80C, HRA, etc.). Good if you invest in tax-saving instruments.</li>
                        <li><strong>New Tax Regime:</strong> Lower tax rates BUT no deductions allowed (except ‚Çπ75,000 standard deduction). Good if you don't make many tax-saving investments.</li>
                    </ul>
                </div>

                <!-- Tax Working Details -->
                <div class="section">
                    <h2 class="section-title toggle-section" onclick="toggleSection('old-regime-working')">
                        üìù Old Tax Regime - Detailed Breakdown
                    </h2>
                    <div class="section-description">
                        Click to see exactly how we calculated your tax in the Old Regime, step by step.
                    </div>
                    <div class="collapsible-content" id="old-regime-working"></div>
                </div>

                <div class="section">
                    <h2 class="section-title toggle-section" onclick="toggleSection('new-regime-working')">
                        üìù New Tax Regime - Detailed Breakdown
                    </h2>
                    <div class="section-description">
                        Click to see exactly how we calculated your tax in the New Regime, step by step.
                    </div>
                    <div class="collapsible-content" id="new-regime-working"></div>
                </div>

                <!-- Additional Information -->
                <div class="help-section">
                    <h3>üí° What Should I Do Next?</h3>
                    <ul>
                        <li><strong>If Old Regime is better:</strong> Make sure you submit investment proofs to your employer. Keep receipts for 80C investments, health insurance premiums, and rent receipts.</li>
                        <li><strong>If New Regime is better:</strong> You can simply opt for the New Regime. You don't need to submit investment proofs, making it simpler.</li>
                        <li><strong>When to inform:</strong> You should inform your employer about your choice at the start of the financial year or when you join. You can change your choice once a year if you're salaried.</li>
                        <li><strong>Need help?</strong> Consider consulting a Chartered Accountant (CA) for personalized advice, especially if you have complex income sources.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tax slabs for FY 2025-26
        const OLD_REGIME_SLABS = [
            { limit: 250000, rate: 0 },
            { limit: 500000, rate: 5 },
            { limit: 1000000, rate: 20 },
            { limit: Infinity, rate: 30 }
        ];

        const NEW_REGIME_SLABS = [
            { limit: 400000, rate: 0 },
            { limit: 800000, rate: 5 },
            { limit: 1200000, rate: 10 },
            { limit: 1600000, rate: 15 },
            { limit: 2000000, rate: 20 },
            { limit: 2400000, rate: 25 },
            { limit: Infinity, rate: 30 }
        ];

        const STANDARD_DEDUCTION = 75000;
        let currentInputMode = 'annual'; // 'annual' or 'monthly'

        function toggleInputMode(mode) {
            const wasAnnual = currentInputMode === 'annual';
            currentInputMode = mode;

            // Update button states
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Get current values and convert
            const salaryFields = ['basic-salary', 'hra', 'special-allowance', 'other-allowances'];
            
            salaryFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                const currentValue = parseFloat(field.value) || 0;
                
                if (currentValue > 0) {
                    if (mode === 'monthly' && wasAnnual) {
                        // Convert annual to monthly
                        field.value = Math.round(currentValue / 12);
                    } else if (mode === 'annual' && !wasAnnual) {
                        // Convert monthly to annual
                        field.value = Math.round(currentValue * 12);
                    }
                }

                // Update placeholder
                if (mode === 'monthly') {
                    if (fieldId === 'basic-salary') field.placeholder = 'e.g., 50000';
                    if (fieldId === 'hra') field.placeholder = 'e.g., 20000';
                    if (fieldId === 'special-allowance') field.placeholder = 'e.g., 15000';
                    if (fieldId === 'other-allowances') field.placeholder = 'e.g., 5000';
                } else {
                    if (fieldId === 'basic-salary') field.placeholder = 'e.g., 600000';
                    if (fieldId === 'hra') field.placeholder = 'e.g., 240000';
                    if (fieldId === 'special-allowance') field.placeholder = 'e.g., 180000';
                    if (fieldId === 'other-allowances') field.placeholder = 'e.g., 60000';
                }
            });

            // Update info text
            const infoText = mode === 'monthly' ? 'Monthly amount' : 'Annual amount';
            document.getElementById('basic-info').textContent = infoText;
            document.getElementById('hra-info').textContent = infoText;
            document.getElementById('special-info').textContent = infoText;
            document.getElementById('other-info').textContent = infoText;
        }

        function getAnnualValue(fieldId) {
            const value = parseFloat(document.getElementById(fieldId).value) || 0;
            if (currentInputMode === 'monthly' && 
                ['basic-salary', 'hra', 'special-allowance', 'other-allowances'].includes(fieldId)) {
                return value * 12;
            }
            return value;
        }

        function calculateHRAExemption(basic, hra, rentPaid, isMetro) {
            if (rentPaid === 0) return 0;
            
            const metroPercentage = isMetro ? 0.5 : 0.4;
            const option1 = hra;
            const option2 = metroPercentage * basic;
            const option3 = Math.max(0, rentPaid - (0.1 * basic));
            
            return Math.min(option1, option2, option3);
        }

        function calculateTaxOldRegime(grossIncome, deductions, hraExemption) {
            const totalDeductions = deductions + STANDARD_DEDUCTION + hraExemption;
            const taxableIncome = Math.max(0, grossIncome - totalDeductions);
            
            let tax = 0;
            let prevLimit = 0;
            const breakdown = [];

            for (let slab of OLD_REGIME_SLABS) {
                if (taxableIncome > prevLimit) {
                    const taxableInSlab = Math.min(taxableIncome, slab.limit) - prevLimit;
                    const taxInSlab = (taxableInSlab * slab.rate) / 100;
                    tax += taxInSlab;
                    
                    if (taxableInSlab > 0) {
                        breakdown.push({
                            range: `‚Çπ${prevLimit.toLocaleString('en-IN')} - ‚Çπ${slab.limit === Infinity ? '‚àû' : slab.limit.toLocaleString('en-IN')}`,
                            rate: slab.rate,
                            taxable: taxableInSlab,
                            tax: taxInSlab
                        });
                    }
                }
                prevLimit = slab.limit;
            }

            // Add 4% cess
            const cess = tax * 0.04;
            const totalTax = tax + cess;

            return {
                grossIncome,
                totalDeductions,
                taxableIncome,
                tax,
                cess,
                totalTax,
                breakdown,
                hraExemption
            };
        }

        function calculateTaxNewRegime(grossIncome) {
            const totalDeductions = STANDARD_DEDUCTION;
            const taxableIncome = Math.max(0, grossIncome - totalDeductions);
            
            let tax = 0;
            let prevLimit = 0;
            const breakdown = [];

            for (let slab of NEW_REGIME_SLABS) {
                if (taxableIncome > prevLimit) {
                    const taxableInSlab = Math.min(taxableIncome, slab.limit) - prevLimit;
                    const taxInSlab = (taxableInSlab * slab.rate) / 100;
                    tax += taxInSlab;
                    
                    if (taxableInSlab > 0) {
                        breakdown.push({
                            range: `‚Çπ${prevLimit.toLocaleString('en-IN')} - ‚Çπ${slab.limit === Infinity ? '‚àû' : slab.limit.toLocaleString('en-IN')}`,
                            rate: slab.rate,
                            taxable: taxableInSlab,
                            tax: taxInSlab
                        });
                    }
                }
                prevLimit = slab.limit;
            }

            // Rebate under Section 87A (if taxable income <= 7 lakh)
            let rebate = 0;
            if (taxableIncome <= 700000) {
                rebate = Math.min(tax, 60000); // Updated rebate limit to match new slabs
            }

            const taxAfterRebate = tax - rebate;
            const cess = taxAfterRebate * 0.04;
            const totalTax = taxAfterRebate + cess;

            return {
                grossIncome,
                totalDeductions,
                taxableIncome,
                tax,
                rebate,
                cess,
                totalTax,
                breakdown
            };
        }

        function displayResults(oldRegime, newRegime, grossIncome) {
            const recommended = oldRegime.totalTax < newRegime.totalTax ? 'old' : 'new';
            const savings = Math.abs(oldRegime.totalTax - newRegime.totalTax);

            // Display comparison cards
            const comparisonHTML = `
                <div class="regime-card ${recommended === 'old' ? 'recommended' : ''}">
                    <h3>Old Tax Regime</h3>
                    <div class="tax-amount">‚Çπ${Math.round(oldRegime.totalTax).toLocaleString('en-IN')}</div>
                    <div class="detail-row">
                        <span>Gross Income:</span>
                        <strong>‚Çπ${grossIncome.toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Total Deductions:</span>
                        <strong>‚Çπ${Math.round(oldRegime.totalDeductions).toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Taxable Income:</span>
                        <strong>‚Çπ${Math.round(oldRegime.taxableIncome).toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Tax Before Cess:</span>
                        <strong>‚Çπ${Math.round(oldRegime.tax).toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Health & Education Cess (4%):</span>
                        <strong>‚Çπ${Math.round(oldRegime.cess).toLocaleString('en-IN')}</strong>
                    </div>
                </div>

                <div class="regime-card ${recommended === 'new' ? 'recommended' : ''}">
                    <h3>New Tax Regime</h3>
                    <div class="tax-amount">‚Çπ${Math.round(newRegime.totalTax).toLocaleString('en-IN')}</div>
                    <div class="detail-row">
                        <span>Gross Income:</span>
                        <strong>‚Çπ${grossIncome.toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Standard Deduction:</span>
                        <strong>‚Çπ${STANDARD_DEDUCTION.toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Taxable Income:</span>
                        <strong>‚Çπ${Math.round(newRegime.taxableIncome).toLocaleString('en-IN')}</strong>
                    </div>
                    <div class="detail-row">
                        <span>Tax Before Rebate:</span>
                        <strong>‚Çπ${Math.round(newRegime.tax).toLocaleString('en-IN')}</strong>
                    </div>
                    ${newRegime.rebate > 0 ? `
                    <div class="detail-row">
                        <span>Rebate u/s 87A:</span>
                        <strong>-‚Çπ${Math.round(newRegime.rebate).toLocaleString('en-IN')}</strong>
                    </div>` : ''}
                    <div class="detail-row">
                        <span>Health & Education Cess (4%):</span>
                        <strong>‚Çπ${Math.round(newRegime.cess).toLocaleString('en-IN')}</strong>
                    </div>
                    ${savings > 0 ? `
                    <div class="savings-highlight">
                        <p>You save <strong>‚Çπ${Math.round(savings).toLocaleString('en-IN')}</strong> with ${recommended === 'new' ? 'New' : 'Old'} Regime!</p>
                    </div>` : ''}
                </div>
            `;

            document.getElementById('comparison-cards').innerHTML = comparisonHTML;

            // Display detailed working for old regime
            let oldWorkingHTML = '<div class="working-section">';
            oldWorkingHTML += '<h4>Income Computation</h4>';
            oldWorkingHTML += `<div class="calculation-step">Gross Total Income: ‚Çπ${grossIncome.toLocaleString('en-IN')}</div>`;
            if (oldRegime.hraExemption > 0) {
                oldWorkingHTML += `<div class="calculation-step">Less: HRA Exemption: ‚Çπ${Math.round(oldRegime.hraExemption).toLocaleString('en-IN')}</div>`;
            }
            oldWorkingHTML += `<div class="calculation-step">Less: Standard Deduction: ‚Çπ${STANDARD_DEDUCTION.toLocaleString('en-IN')}</div>`;
            oldWorkingHTML += `<div class="calculation-step">Less: Chapter VI-A Deductions: ‚Çπ${Math.round(oldRegime.totalDeductions - STANDARD_DEDUCTION - oldRegime.hraExemption).toLocaleString('en-IN')}</div>`;
            oldWorkingHTML += `<div class="calculation-step"><strong>Total Taxable Income: ‚Çπ${Math.round(oldRegime.taxableIncome).toLocaleString('en-IN')}</strong></div>`;
            oldWorkingHTML += '</div>';

            oldWorkingHTML += '<div class="working-section">';
            oldWorkingHTML += '<h4>Tax Calculation</h4>';
            for (let step of oldRegime.breakdown) {
                oldWorkingHTML += `<div class="calculation-step">${step.range} @ ${step.rate}%: ‚Çπ${Math.round(step.taxable).toLocaleString('en-IN')} √ó ${step.rate}% = ‚Çπ${Math.round(step.tax).toLocaleString('en-IN')}</div>`;
            }
            oldWorkingHTML += `<div class="calculation-step"><strong>Total Tax: ‚Çπ${Math.round(oldRegime.tax).toLocaleString('en-IN')}</strong></div>`;
            oldWorkingHTML += `<div class="calculation-step">Add: Health & Education Cess @ 4%: ‚Çπ${Math.round(oldRegime.cess).toLocaleString('en-IN')}</div>`;
            oldWorkingHTML += `<div class="calculation-step" style="background: #e8f5e9;"><strong>Total Tax Liability: ‚Çπ${Math.round(oldRegime.totalTax).toLocaleString('en-IN')}</strong></div>`;
            oldWorkingHTML += '</div>';

            document.getElementById('old-regime-working').innerHTML = oldWorkingHTML;

            // Display detailed working for new regime
            let newWorkingHTML = '<div class="working-section">';
            newWorkingHTML += '<h4>Income Computation</h4>';
            newWorkingHTML += `<div class="calculation-step">Gross Total Income: ‚Çπ${grossIncome.toLocaleString('en-IN')}</div>`;
            newWorkingHTML += `<div class="calculation-step">Less: Standard Deduction: ‚Çπ${STANDARD_DEDUCTION.toLocaleString('en-IN')}</div>`;
            newWorkingHTML += `<div class="calculation-step"><strong>Total Taxable Income: ‚Çπ${Math.round(newRegime.taxableIncome).toLocaleString('en-IN')}</strong></div>`;
            newWorkingHTML += '</div>';

            newWorkingHTML += '<div class="working-section">';
            newWorkingHTML += '<h4>Tax Calculation</h4>';
            for (let step of newRegime.breakdown) {
                newWorkingHTML += `<div class="calculation-step">${step.range} @ ${step.rate}%: ‚Çπ${Math.round(step.taxable).toLocaleString('en-IN')} √ó ${step.rate}% = ‚Çπ${Math.round(step.tax).toLocaleString('en-IN')}</div>`;
            }
            newWorkingHTML += `<div class="calculation-step"><strong>Tax Before Rebate: ‚Çπ${Math.round(newRegime.tax).toLocaleString('en-IN')}</strong></div>`;
            if (newRegime.rebate > 0) {
                newWorkingHTML += `<div class="calculation-step">Less: Rebate u/s 87A: ‚Çπ${Math.round(newRegime.rebate).toLocaleString('en-IN')}</div>`;
                newWorkingHTML += `<div class="calculation-step"><strong>Tax After Rebate: ‚Çπ${Math.round(newRegime.tax - newRegime.rebate).toLocaleString('en-IN')}</strong></div>`;
            }
            newWorkingHTML += `<div class="calculation-step">Add: Health & Education Cess @ 4%: ‚Çπ${Math.round(newRegime.cess).toLocaleString('en-IN')}</div>`;
            newWorkingHTML += `<div class="calculation-step" style="background: #e8f5e9;"><strong>Total Tax Liability: ‚Çπ${Math.round(newRegime.totalTax).toLocaleString('en-IN')}</strong></div>`;
            newWorkingHTML += '</div>';

            document.getElementById('new-regime-working').innerHTML = newWorkingHTML;
        }

        async function getAIRecommendation(oldRegime, newRegime, inputs) {
            const prompt = `You are a tax expert helping an Indian taxpayer choose between the Old and New tax regimes under the Income Tax Act, 1961.

Here's the taxpayer's situation:
- Gross Annual Income: ‚Çπ${inputs.grossIncome.toLocaleString('en-IN')}
- Total Deductions claimed (Old Regime): ‚Çπ${inputs.totalDeductions.toLocaleString('en-IN')}
  - 80C: ‚Çπ${inputs.section80c.toLocaleString('en-IN')}
  - 80D: ‚Çπ${inputs.section80d.toLocaleString('en-IN')}
  - 80CCD(1B): ‚Çπ${inputs.section80ccd.toLocaleString('en-IN')}
  - HRA Exemption: ‚Çπ${Math.round(oldRegime.hraExemption).toLocaleString('en-IN')}

Tax Calculation Results:
- Old Regime Tax: ‚Çπ${Math.round(oldRegime.totalTax).toLocaleString('en-IN')}
- New Regime Tax: ‚Çπ${Math.round(newRegime.totalTax).toLocaleString('en-IN')}
- Difference: ‚Çπ${Math.abs(Math.round(oldRegime.totalTax - newRegime.totalTax)).toLocaleString('en-IN')}

Provide a clear, concise recommendation (2-3 paragraphs maximum) on which regime they should choose and why. Consider:
1. Which regime results in lower tax liability
2. The value of deductions they're currently claiming
3. Flexibility and planning opportunities
4. Any suggestions for optimizing their tax position

Keep it practical and actionable. Don't repeat the numbers I've already provided.`;

            try {
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 1000,
                        messages: [
                            { role: "user", content: prompt }
                        ],
                    })
                });

                const data = await response.json();
                const recommendation = data.content.find(item => item.type === "text")?.text || "Unable to generate recommendation.";
                
                return recommendation;
            } catch (error) {
                console.error("Error calling AI:", error);
                return "Unable to generate AI recommendation at this time. Please review the tax calculations above to make your decision.";
            }
        }

        async function calculateTax() {
            // Get all input values (converting monthly to annual if needed)
            const basicSalary = getAnnualValue('basic-salary');
            const hra = getAnnualValue('hra');
            const specialAllowance = getAnnualValue('special-allowance');
            const otherAllowances = getAnnualValue('other-allowances');
            const bonus = parseFloat(document.getElementById('bonus').value) || 0;
            const otherIncome = parseFloat(document.getElementById('other-income').value) || 0;

            const section80c = Math.min(parseFloat(document.getElementById('section-80c').value) || 0, 150000);
            const section80d = parseFloat(document.getElementById('section-80d').value) || 0;
            const section80ccd = Math.min(parseFloat(document.getElementById('section-80ccd').value) || 0, 50000);
            const section80e = parseFloat(document.getElementById('section-80e').value) || 0;
            const rentPaid = parseFloat(document.getElementById('rent-paid').value) || 0;
            const isMetro = document.getElementById('metro-city').value === 'yes';

            const grossIncome = basicSalary + hra + specialAllowance + otherAllowances + bonus + otherIncome;

            if (grossIncome === 0) {
                alert('Please enter your income details to calculate tax.');
                return;
            }

            // Show loading
            document.getElementById('loading').classList.add('show');
            document.getElementById('results').classList.remove('show');

            // Calculate HRA exemption
            const hraExemption = calculateHRAExemption(basicSalary, hra, rentPaid, isMetro);

            // Calculate total deductions for old regime
            const totalDeductions = section80c + section80d + section80ccd + section80e;

            // Calculate tax for both regimes
            const oldRegime = calculateTaxOldRegime(grossIncome, totalDeductions, hraExemption);
            const newRegime = calculateTaxNewRegime(grossIncome);

            // Display basic results
            displayResults(oldRegime, newRegime, grossIncome);

            // Get AI recommendation
            const aiRecommendation = await getAIRecommendation(oldRegime, newRegime, {
                grossIncome,
                totalDeductions,
                section80c,
                section80d,
                section80ccd,
                hraExemption
            });

            // Display AI recommendation
            const aiHTML = `
                <div class="ai-recommendation">
                    <h3>AI-Powered Recommendation</h3>
                    ${aiRecommendation.split('\n\n').map(para => `<p>${para}</p>`).join('')}
                </div>
            `;
            document.getElementById('ai-recommendation').innerHTML = aiHTML;

            // Hide loading and show results
            document.getElementById('loading').classList.remove('show');
            document.getElementById('results').classList.add('show');

            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function resetForm() {
            document.querySelectorAll('input[type="number"]').forEach(input => {
                input.value = '0';
            });
            document.getElementById('results').classList.remove('show');
        }

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const title = section.previousElementSibling;
            
            section.classList.toggle('collapsed');
            title.classList.toggle('collapsed');
        }
    </script>
</body>
</html>
